<Window x:Class="ChatDesktop.App.Views.TaskDispatchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="任务派发" Height="420" Width="420" WindowStartupLocation="CenterOwner">
  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <StackPanel Orientation="Horizontal" Grid.Row="0">
      <TextBlock Text="派发类型" VerticalAlignment="Center" Margin="0,0,8,0" />
      <ComboBox Width="120" ItemsSource="{Binding AssignedToTypeOptions}"
                SelectedItem="{Binding AssignedToType, Mode=TwoWay}" />
      <Button Content="刷新候选" Command="{Binding LoadCandidatesCommand}" Margin="12,0,0,0" />
    </StackPanel>

    <Border Grid.Row="1" Margin="0,12,0,0" Padding="8" BorderBrush="#E5E5E5" BorderThickness="1">
      <StackPanel>
        <TextBlock Text="用户候选" FontWeight="Bold" />
        <ListBox ItemsSource="{Binding Candidates}" SelectedItem="{Binding SelectedCandidate, Mode=TwoWay}" Height="140">
          <ListBox.ItemTemplate>
            <DataTemplate>
              <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding EmpName}" Margin="0,0,8,0" />
                <TextBlock Text="{Binding EmpNo}" Foreground="#666" />
              </StackPanel>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </StackPanel>
    </Border>

    <Border Grid.Row="2" Margin="0,12,0,0" Padding="8" BorderBrush="#E5E5E5" BorderThickness="1">
      <StackPanel>
        <TextBlock Text="团队名称" FontWeight="Bold" />
        <TextBox Text="{Binding CustomTarget, UpdateSourceTrigger=PropertyChanged}" />
      </StackPanel>
    </Border>

    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
      <TextBlock Text="{Binding Error}" Foreground="#C62828" Margin="0,0,8,0"
                 Visibility="{Binding Error, Converter={StaticResource StringNotEmptyToVisibilityConverter}}" />
      <Button Content="取消" Command="{Binding CancelCommand}" Margin="0,0,8,0" />
      <Button Content="确认派发" Command="{Binding ConfirmCommand}" />
    </StackPanel>
  </Grid>
</Window>
